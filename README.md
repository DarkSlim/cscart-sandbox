# Cs-cart Sandbox окружение.
Готовое окружение для разработки Cs-Cart на основе Docker.

## Необходимый софт
* [Docker](https://docs.docker.com/install/#supported-platforms)
* [Docker Compose](https://docs.docker.com/compose/install/)
#
## **Как Запустить**
## Шаг 1. Копирование и подготовка файла переменных.

* Если используем локально c самоподписанными сертификатами.

    `$ cp compose/.env.local .env`
   
* Если хотим получить wildcard сертификат (реализовано лишь для selectel и cloudflare) 

    `$ cp compose/.env.external .env`

## Шаг 2. Внести изменения в файл .env 

*Заполненные значения оставляем без изменений*

*Папки для волумов будут созданы автоматически с правильными правами при первом запуске.*

* **Локально**

    `CSCART_VOLUMES` - путь до папки с экземплярами cs-cart *(Будет создана автоматически если не существует)*
 
    `MYSQL_LOGS` - путь до папки с логами Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_DATA` - путь до папки с базами данных Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_CONF` - путь до папки с конфигурационными файлами Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_RPASS` - root пароль для сервера баз данных Mysql
 
* **Wildcard** сертификат через **Selectel**.
 
    `DNS_API=dns_selectel` - тип DNS провайдера для получения wildcard сертификата.
 
    `SL_Key=******` - API ключ для Selectel
 
    `CSCART_VOLUMES` - путь до папки с экземплярами cs-cart *(Будет создана автоматически если не существует)*
 
    `MYSQL_LOGS` - путь до папки с логами Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_DATA` - путь до папки с базами данных Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_CONF` - путь до папки с конфигурационными файлами Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_RPASS` - root пароль для сервера баз данных Mysql
 
    `DOMAIN` - домен для которого будем получать wildcard сертификат
 
    `PHP56_ADDRESS` - поддомен для PHP 5.6
 
    `PHP70_ADDRESS` - поддомен для PHP 7.0
 
    `PHP71_ADDRESS` - поддомен для PHP 7.1
 
    `PHP72_ADDRESS` - поддомен для PHP 7.2

* **Wildcard** сертификат через **Cloudflare**.
    
    `DNS_API=dns_selectel` - тип DNS провайдера для получения wildcard сертификата.
 
    `CF_Key=******` - API ключ для Cloudflare

    `CF_Email` - логин для Cloudflare (email адрес на который зарегистрирована учетная запись)
 
    `CSCART_VOLUMES` - путь до папки с экземплярами cs-cart *(Будет создана автоматически если не существует)*
 
    `MYSQL_LOGS` - путь до папки с логами Mysql *(Будет создана автоматически если не существует)*
  
    `MYSQL_DATA` - путь до папки с базами данных Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_CONF` - путь до папки с конфигурационными файлами Mysql *(Будет создана автоматически если не существует)*
 
    `MYSQL_RPASS` - root пароль для сервера баз данных Mysql
 
    `DOMAIN` - домен для которого будем получать wildcard сертификат
 
    `PHP56_ADDRESS` - поддомен для PHP 5.6
 
    `PHP70_ADDRESS` - поддомен для PHP 7.0
 
    `PHP71_ADDRESS` - поддомен для PHP 7.1
 
    `PHP72_ADDRESS` - поддомен для PHP 7.2

## Шаг 3. Запуск

* Если используем локально c самоподписанными сертификатами.

    `sudo ./launcher local`

    Также необходимо внести записи в файл `/etc/hosts`

    `sudo echo -e '127.0.0.1  php56.cs-cart.local\n127.0.0.1  php70.cs-cart.local\n127.0.0.1  php71.cs-cart.local\n127.0.0.1  php72.cs-cart.local\n' >> /etc/hosts`

* Если хотим получить wildcard сертификат (реализовано лишь для selectel и cloudflare)

    `sudo ./launcher external`

## Доступы

*  Если используем локально c самоподписанными сертификатами.

    `php56.cs-cart.local` - nginx + php-fpm 5.6

    `php70.cs-cart.local` - nginx + php-fpm 7.0

    `php71.cs-cart.local` - nginx + php-fpm 7.1

    `php72.cs-cart.local` - nginx + php-fpm 7.2

    Также на `8080` порту будет доступен [Adminer](https://www.adminer.org) для работы с сервером баз данных

    `database` - адрес сервера баз данных

    `root` - имя пользователя, паролю соответствует значение переменной `${MYSQL_RPASS}` в `.env` 

* Если используем вариант с wildcard сертификатом (реализовано лишь для selectel и cloudflare)

    Адресами являются значения переменных в `.env`:

    `PHP56_ADDRESS` - поддомен для PHP 5.6 - nginx + php-fpm 5.6
 
    `PHP70_ADDRESS` - поддомен для PHP 7.0 - nginx + php-fpm 7.0
 
    `PHP71_ADDRESS` - поддомен для PHP 7.1 - nginx + php-fpm 7.1
 
    `PHP72_ADDRESS` - поддомен для PHP 7.2 - nginx + php-fpm 7.2

    **Прошу учесть, что на `8080` порту будет доступен [Adminer](https://www.adminer.org) для работы с сервером баз данных, используйте Firewall для предотвращения несанкционированного доступа.**

    `database` - адрес сервера баз данных

    `root` - имя пользователя, паролю соответствует значение переменной `${MYSQL_RPASS}` в `.env` 


